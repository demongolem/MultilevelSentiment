Excel Google Flights Airfare Scraping Tool (Excel VBA)
I need an Excel VBA Tool that can extract airfare and other flight information from Google Flights. The tool should run using an interface (mask) that lets me choose the following:
- Departure Airport (code)
- Destination Airports (codes separated by a comma)
- Departure Date
- Return Date
- Class of flight (multiple selection must be available for all classes, which means the query will run once for each class - Economy, Premium Economy, Business, First)
- Maximum number of Stops (Direct, 1,2,3 stops)
- For how many more days from the departure date the query should run (explained below)
The tool must be able to run a query with multiple origin and destinations for the same flight dates and look for data for a custom number of days from the selected start date.
For example, the tool should be able to pull data for JFK-LGW and LAX-DFW with departure on September 1, 2018 with a return flight 7 days later (7 is an example, this should be an input) and looks for flights with the same 7 days duration starting on September 2, 3, 4, 5, etc. (with this as another input parameter).
The exact set of data elements to pull from Google Flights is summarized in a picture attached.
Class and stops should be in the input table (for example, the tool should be able to pull data for economy, premium economy, business, and first class individually or based on checkbox selection, so is the maximum number of stops or direct flights only).
Each origin-destination should be stored in a different sheet, and when new data is pulled that is added to that sheet. For example, the tool creates a sheet named JFK-LGW and keeps storing data in the same sheet for this route.
In addition to run manually, the tool should have a function that lets it to run automatically at a custom time of the day if set to do so.
Please note I connect from Italy so Google flights is by default in Italian and the currency in Euros.
Please let me know if you have any questions. Thank you